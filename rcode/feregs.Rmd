---
title: "feregs"
author: "Claire Jellison"
date: "1/23/2020"
output: pdf_document
---

#what this website is so useful go to it 
#https://www.econometrics-with-r.org/10-3-fixed-effects-regression.html

```{r}
library(plm)
library(xts)
library(dplyr)
library(texreg)
```


```{r}
dhistfe <- dhist %>% ungroup(urlsolid)
#dhistfe$createdxts <- make.time.unique(dhistfe$createdxts)
dhistfe$id <- seq.int(nrow(dhistfe))
dhistfe$createdxtsid  <- paste(dhistfe$createdxts, dhistfe$id, sep="_")
#dhistpanel <- plm.data(dhistfe, index = c("urlsolid", "createdxtsid"))
dhistpanel <- pdata.frame(dhistfe, index = c("urlsolid", "createdxtsid"), drop.index = TRUE)
anchorfe <- plm(amount ~ histavg*lagtype, 
                    data = dhistpanel, 
                    model = "within")
anchorfe2 <- plm(amount ~ histavg*lagtype + is_female + histavg*is_female, 
                    data = dhistpanel, 
                    model = "within")
anchorfe3 <- plm(amount ~ histavg*lagtype + is_anonymous + histavg*is_anonymous, 
                    data = dhistpanel, 
                    model = "within")
summary(anchorfe)
texreg(list(anchorfe, anchorfe2, anchorfe3))
```

```{r}
dhist5sizefe <- dhist5size %>% ungroup(urlsolid)
#dhist5sizefe$createdxts <- make.time.unique(dhistsizefe$createdxts)
dhist5sizefe$id <- seq.int(nrow(dhist5sizefe))
dhist5sizefe$createdxtsid  <- paste(dhist5sizefe$createdxts, dhist5sizefe$id, sep="_")
dhist5sizepanel <- pdata.frame(dhist5sizefe, index = c("urlsolid", "createdxtsid"), drop.index = TRUE)
#anchorfe <- plm(amount ~ histavg*lagtype, 
                    #data = dhist5sizepanel, 
                    #model = "within")
#anchorfe2 <- plm(amount ~ histavg*lagtype + is_female + histavg*is_female, 
                    #data = dhist5sizepanel, 
                    #model = "within")
#anchorfe3 <- plm(amount ~ histavg*lagtype + is_anonymous + histavg*is_anonymous, 
                    #data = dhistsizepanel, 
                   # model = "within")
anchorfe4 <- plm(amount ~ d1 + d2 + d3 + d4 + d5, 
                    data = dhist5sizepanel, 
                    model = "within")
anchorfe5 <- plm(amount ~d1*d2 + d1*d3 + d1*d4 + d1*d5 + d2*d3 + d2*d4 + d2*d5 + d3*d4 + d3*d5 + d4*d5, 
                 data = dhist5sizepanel,  
                 model = "within") 
texreg(anchorfe4)
#summary(anchorfe5)
```

