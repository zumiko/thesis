---
title: "import"
author: "Claire Jellison"
date: "11/24/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readr)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(stringr)
```

```{r}
## Read in data 

pathhist2 <- "/Users/CJ/Desktop/thesisdata/p2/donationhistory.csv" 
pathzip2 <- "/Users/CJ/Desktop/thesisdata/p2/campsbyzip2.csv" 
pathattributes2 <- "/Users/CJ/Desktop/thesisdata/p2/campattributes.csv" 

dhist2 <- read.csv(pathhist2)
dhist2 <- tbl_df(dhist2)

zip2 <- read.csv(pathzip2)
zip2 <- tbl_df(zip2)

campatt2 <- read.csv(pathattributes2)
campatt2<- tbl_df(campatt2)

```

## Read in data 
```{r}
pathhist1 <- "/Users/CJ/Desktop/thesisdata/part1/donationhist.csv" 
pathzip1 <- "/Users/CJ/Desktop/thesisdata/part1/campsbyzip1.csv" 
pathattributes1 <- "/Users/CJ/Desktop/thesisdata/part1/campattributes.csv" 
pathhist2 <- "/Users/CJ/Desktop/thesisdata/part2/donationhist.csv" 
#pathzip2 <- "/Users/CJ/Desktop/thesisdata/part2/campsbyzip2.csv" 
#pathattributes2 <- "/Users/CJ/Desktop/thesisdata/part2/campattributes.csv" 

dhist1 <- read.csv(pathhist1)
dhist1 <- tbl_df(dhist1)
dhist2 <- read.csv(pathhist2)
dhist2 <- tbl_df(dhist2)

zip1 <- read.csv(pathzip1)
zip1 <- tbl_df(zip1)
#zip2 <- read.csv(pathzip2)
#zip2 <- tbl_df(zip2)

campatt1 <- read.csv(pathattributes1)
campatt1<- tbl_df(campatt1)
#campatt2<- read.csv(pathattributes2)
#campatt2<- tbl_df(campatt2)

```



```{r}
#this function stacks the csvs
lapply_read_csv_bind_rows <- function(path, pattern = "*.csv") {
    files = list.files(path, pattern, full.names = TRUE)
    lapply(files, read_csv) %>% bind_rows()
}
```

```{r}
nrow(dhist2)
nrow(zip2)
nrow(campatt2)
head(campatt2, 200)
```


# okay so need to account for the discrepancy btwn zip2 and campatt2 - done! they all seem to have no campaign pages
#then figure out discrepancy btwn campatt2 ad dhist2  - done! none of these seem to have donations

```{r}
nrow(zip2) - nrow(campatt2) #difference in number of camps
missingcamps <- anti_join(zip2, campatt2, by = "X")
missingcamps  #okay all of these campaigns lead to a campaign not found page so this seems fine
```

```{r}
nrow(campatt2)
dhist2check <- dhist2 %>% group_by(urlsolid) %>% summarise(donations = n_distinct(donation_id))
nrow(dhist2check)
head(dhist2check)
```

```{r}
campatt2 <- campatt2 %>% rename(urlsolid = urlname) 
missingcamps2 <- anti_join(campatt2, dhist2check, by = "urlsolid")  
missingcamps2
```

