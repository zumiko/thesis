---
title: "regs"
author: "Claire Jellison"
date: "12/26/2019"
output: pdf_document
---

```{r}
library(texreg)
library(dplyr)
```

#https://drsimonj.svbtle.com/visualising-residuals for looking at residuals
```{r}
#mean reg
meanlm <- lm(amount ~ histavg, data = dhist1)
meanlm2 <- lm(amount ~ histavg + is_anonymous + is_anonymous*histavg, data = dhist1)
meanlm3 <- lm(amount ~ histavg + is_female+ isfemale*histavg, data = dhist1)
meanlm4 <- lm(amount ~ histavg + category + histavg*category, data = dfc1)
summary(meanlm4)
plot(meanlm, which=1, col=c("blue"), xlim=c(0,1000))
d <- dhist1 %>% select(amount, histavg, urlsolid) %>% filter(histavg >= 0) #exclude those with no aggregate anchor
d$predicted <- predict(meanlm)  #get predicted vals
d$residuals <- residuals(meanlm) #get residuals
d<- d %>% filter(urlsolid == "1axvo")
ggplot(d, aes(x = histavg, y = amount)) +  
  geom_point() + xlim(0, 200) + ylim(0, 300) + 
  geom_point(aes(y = predicted), shape = 1) + 
  geom_segment(aes(xend = histavg, yend = predicted), alpha = .2) 
#texreg(list(meanlm, meanlm2, meanlm3))
#texreg(meanlm4, fontsize = "tiny")
```

```{r}
#this reg takes into account the seed money 
meanseedlm <- lm(amount ~ percentraised, data = dfc1)
summary(meanseedlm)
#texreg(meanseedlm)
```


```{r}
#anon reg
anonlm <- glm(is_anonymous ~ anonpropscreen, data = dhist1, family = "binomial")
summary(anonlm)
texreg(anonlm)
```

```{r}
#gender reg 
genderlm <- lm(amount ~ gender, data = dhist1)
summary(genderlm)
texreg(genderlm)
```

```{r}
#combo 
alllm <- lm(amount ~ histavg + anonpropscreen +  gender, data = dhist1, family = "binomial")
summary(alllm)
#texreg(alllm)
```



```{r}
head(dhist2short)
dhist2short <- dhist2short %>% mutate(timeafter = difftime(createdxtslead, createdxts, units = "secs"))
dhist2short <- dhist2short %>% mutate(dow = weekdays(createdxts))
dhist2short <- dhist2short %>% mutate(month = months(createdxts))

dg <- dhist2short %>% filter(urlsolid == "CarlieTy")	
ggplot(dg, aes(x=timeafter)) + geom_histogram() + xlim(0,10000)
```

```{r}
#reg on time after
timeafterlm <- lm(amount ~ timeafter*histavg + gender*histavg + anonpropscreen*histavg + dow + month, data = dhist2short)
summary(timeafterlm)
```

#trying now for median 


```{r}
medianlm <- lm(amount ~ d3, data = dhist2tree)
summary(medianlm)
maxlm <- lm(amount ~ d5, data = dhist2tree)
summary(maxlm)
alllm <- lm(amount ~ d1 + d2 + d3 + d4 + d5, data = dhist2tree)
summary(alllm)
allinterlm <- lm(amount ~ d1*d2 + d1*d3 + d1*d4 + d1*d5 + d2*d3 + d2*d4 + d2*d5 + d3*d4 + d3*d5 + d4*d5, data = dhist2tree)
summary(allinterlm)
dhist2tree <- dhist2tree %>% mutate(d12 = d2 - d1) %>% mutate(d23 = d3 - d2) %>% mutate(d34 = d4 - d3) %>% mutate(d45 = d5 -d4)
distlm <- lm(amount ~ d1 + d12 + d23 + d34 + d45, data = dhist2tree)
distlm2 <- lm(amount ~ d1*d12 + d12 + d23 + d34 + d45, data = dhist2tree)
summary(distlm2)
texreg(distlm)
plot(distlm)
texreg(allinterlm)
```

