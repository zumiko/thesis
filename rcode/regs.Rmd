---
title: "regs"
author: "Claire Jellison"
date: "12/26/2019"
output: pdf_document
---

```{r}
library(texreg)
library(dplyr)
```

#https://drsimonj.svbtle.com/visualising-residuals for looking at residuals
```{r}
#mean reg
dfc <- dfc %>% filter(lagtype != "unknown")
meanlm <- lm(amount ~ histavg*lagtype, data = dfc)
meanlm2 <- lm(amount ~ histavg*lagtype + is_anonymous*histavg , data = dfc)
meanlm3 <- lm(amount ~ histavg*lagtype + is_female*histavg , data = dfc)
meanlm4 <- lm(amount ~ histavg*lagtype + nonprofit*histavg, data = dfc)
texreg(list(meanlm, meanlm2, meanlm3))
#texreg(meanlm4, fontsize = "tiny")
```

```{r}
categorylm <- lm(amount ~ histavg*lagtype + category*histavg, data = dfc)
texreg(categorylm)
```



```{r}
#anon reg
anonlm <- glm(is_anonymous ~ anonprop, data = dhist2, family = "binomial")
summary(anonlm)
texreg(anonlm)
```


```{r}
#combo 
alllm <- lm(amount ~ histavg + anonprop +  gender, data = dhist2, family = "binomial")
summary(alllm)
#texreg(alllm)
```

```{r}
#reg on time after
timeafterlm <- lm(amount ~ timeafter*histavg + gender*histavg + anonpropscreen*histavg + dow + month, data = dhist2tree)
summary(timeafterlm)
```

#trying now for median 


```{r}
medianlm <- lm(amount ~ d3, data = dhistsize)
summary(medianlm)
maxlm <- lm(amount ~ d5, data = dhistsize)
summary(maxlm)
alllm <- lm(amount ~ d1 + d2 + d3 + d4 + d5, data = dhistsize)
summary(alllm)
allinterlm <- lm(amount ~ d1*d2 + d1*d3 + d1*d4 + d1*d5 + d2*d3 + d2*d4 + d2*d5 + d3*d4 + d3*d5 + d4*d5 + is_female, data = dhistsize)
summary(allinterlm)
dhistsize <- dhistsize %>% mutate(d12 = d2 - d1) %>% mutate(d23 = d3 - d2) %>% mutate(d34 = d4 - d3) %>% mutate(d45 = d5 -d4)
distlm <- lm(amount ~ d1 + d12  +  d23 + d34  + d45, data = dhistsize)
summary(distlm)
texreg(distlm)
plot(distlm)
texreg(allinterlm)
```

