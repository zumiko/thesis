---
title: "regs"
author: "Claire Jellison"
date: "12/26/2019"
output: pdf_document
---

```{r}
library(texreg)
library(dplyr)
```

#https://drsimonj.svbtle.com/visualising-residuals for looking at residuals
```{r}
#mean reg
meanlm <- lm(amount ~ histavg, data = dhist1)
meanlm2 <- lm(amount ~ histavg + is_anonymous + is_anonymous*histavg, data = dhist1)
meanlm3 <- lm(amount ~ histavg + is_anonymous + isfemale*histavg, data = dhist1)
summary(meanlm)
plot(meanlm, which=1, col=c("blue"), xlim=c(0,1000))
d <- dhist1 %>% select(amount, histavg, urlsolid) %>% filter(histavg >= 0) #exclude those with no aggregate anchor
d$predicted <- predict(meanlm)  #get predicted vals
d$residuals <- residuals(meanlm) #get residuals
d<- d %>% filter(urlsolid == "1axvo")
ggplot(d, aes(x = histavg, y = amount)) +  
  geom_point() + xlim(0, 200) + ylim(0, 300) + 
  geom_point(aes(y = predicted), shape = 1) + 
  geom_segment(aes(xend = histavg, yend = predicted), alpha = .2) 
#exreg(list(meanlm, meanlm2, meanlm3))
```

```{r}
#this reg takes into account the seed money 
meanseedlm <- lm(amount ~ percentraised, data = dfc1)
summary(meanseedlm)
#texreg(meanseedlm)
```


```{r}
#anon reg
anonlm <- glm(is_anonymous ~ anonpropscreen, data = dhist1, family = "binomial")
summary(anonlm)
texreg(anonlm)
```

```{r}
#gender reg 
genderlm <- lm(amount ~ gender, data = dhist1)
summary(genderlm)
texreg(genderlm)
```

```{r}
#combo 
alllm <- lm(amount ~ histavg + anonpropscreen +  gender, data = dhist1, family = "binomial")
summary(alllm)
#texreg(alllm)
```

