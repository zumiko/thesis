---
title: "regs"
author: "Claire Jellison"
date: "12/26/2019"
output: pdf_document
---

```{r}
library(texreg)
library(dplyr)
```

#https://drsimonj.svbtle.com/visualising-residuals for looking at residuals
```{r}
#mean reg
dhist2 <- dhist2 %>% filter(lagtype != "unknown")
meanlm <- lm(amount ~ histavg + lagtype, data = dhist2)
meanlm2 <- lm(amount ~ histavg + is_anonymous + is_anonymous*histavg + lagtype, data = dhist2)
meanlm3 <- lm(amount ~ histavg + is_female+ is_female*histavg + lagtype, data = dhist2)
meanlm4 <- lm(amount ~ histavg + is_female*histavg + is_anonymous*histavg + lagtype, data = dhist2)
summary(meanlm)
#plot(meanlm, which=1, col=c("blue"), xlim=c(0,1000))
#d <- dhist1 %>% select(amount, histavg, urlsolid) %>% filter(histavg >= 0) #exclude those with no aggregate anchor
#d$predicted <- predict(meanlm)  #get predicted vals
#d$residuals <- residuals(meanlm) #get residuals
#d<- d %>% filter(urlsolid == "1axvo")
#ggplot(d, aes(x = histavg, y = amount)) +  
  #geom_point() + xlim(0, 200) + ylim(0, 300) + 
  #geom_point(aes(y = predicted), shape = 1) + 
  #geom_segment(aes(xend = histavg, yend = predicted), alpha = .2) 
texreg(list(meanlm, meanlm2, meanlm3))
#texreg(meanlm4, fontsize = "tiny")
```



```{r}
#anon reg
anonlm <- glm(is_anonymous ~ anonprop, data = dhist2, family = "binomial")
summary(anonlm)
texreg(anonlm)
```

```{r}
#gender reg 
genderlm <- lm(amount ~ gender, data = dhist2)
summary(genderlm)
texreg(genderlm)
```

```{r}
#combo 
alllm <- lm(amount ~ histavg + anonprop +  gender, data = dhist2, family = "binomial")
summary(alllm)
#texreg(alllm)
```

```{r}
#reg on time after
timeafterlm <- lm(amount ~ timeafter*histavg + gender*histavg + anonpropscreen*histavg + dow + month, data = dhist2tree)
summary(timeafterlm)
```

#trying now for median 


```{r}
medianlm <- lm(amount ~ d3, data = dhist2tree)
summary(medianlm)
maxlm <- lm(amount ~ d5, data = dhist2tree)
summary(maxlm)
alllm <- lm(amount ~ d1 + d2 + d3 + d4 + d5, data = dhist2tree)
summary(alllm)
allinterlm <- lm(amount ~ d1*d2 + d1*d3 + d1*d4 + d1*d5 + d2*d3 + d2*d4 + d2*d5 + d3*d4 + d3*d5 + d4*d5, data = dhist2tree)
summary(allinterlm)
dhist2tree <- dhist2tree %>% mutate(d12 = d2 - d1) %>% mutate(d23 = d3 - d2) %>% mutate(d34 = d4 - d3) %>% mutate(d45 = d5 -d4)
distlm <- lm(amount ~ d1 + d12 + d23 + d34 + d45, data = dhist2tree)
distlm2 <- lm(amount ~ d1*d12 + d12 + d23 + d34 + d45, data = dhist2tree)
summary(distlm2)
texreg(distlm)
plot(distlm)
texreg(allinterlm)
```

