---
title: "summary stats"
author: "Claire Jellison"
date: "12/27/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(ggplot2)
library(readr)
library(tidyverse)
library(lubridate)
library(quantmod)
library(ggpointdensity)
```


```{r}
df <- read.csv("dhist1to4.csv")
dhist <- tbl_df(df)

df2 <- read.csv("dhist5to8.csv")
dhisttest <- tbl_df(df2)
dhisttest <- sumstats(dhisttest)

dhistall <- read.csv("dfc.csv")
```


```{r}
#corresponds to table 2.1
nrow(dhistall)
mean(dhistall$amount)
sum(dhistall$amount)
median(dhistall$amount)

anonhist <- dhistall %>% dplyr::filter(gender == "anonymous")
nrow(anonhist)
mean(anonhist$amount)

malehist <- dhistall %>% dplyr::filter(gender == "male")
nrow(malehist)
mean(malehist$amount)

femalehist <- dhistall %>% dplyr::filter(gender == "female")
nrow(femalehist)
mean(femalehist$amount)

unknownhist <- dhistall %>% dplyr::filter(is.na(gender))
nrow(unknownhist)
mean(unknownhist$amount)

dhistsum <- dhistall %>% group_by(category) %>% group_by(gender, add = TRUE) %>% summarize(total = n(), meand = mean(amount)) %>% arrange(desc(total), .by_group = TRUE)
dhistsum

ggplot(dhistall, aes(x = category, y = amount, color = gender)) + geom_boxplot() + ylim(0,150)  + theme(axis.text.x = element_text(angle = 90, hjust = 1))
```



```{r}
#this is figure 2.4 
dfc %>% dplyr::filter(terminated != TRUE) %>% distinct(urlsolid, .keep_all = TRUE) %>% mutate(progress = progress *100) %>%
ggplot( aes(x = progress)) + geom_histogram(aes(y=..density..), colour="black", fill="white") +
 geom_density(alpha=.2, fill="#FF6666") + xlim(0,150) 
ggsave("pdffund.png", width = 7, height = 4, units = "in")
```



```{r}
#this is figure 2.3
ggplot(dhistall, aes(x = amount)) + geom_histogram(binwidth = 5, color="steelblue", fill="white", position = "identity") + xlim(0,120) 
ggsave("amtdist.png", width = 7, height = 4, units = "in")
```


```{r}
#this is figure 2.5
dhistall$month <- fct_relevel(dhistall$month, levels = c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"))
                           
ggplot(dhistall, aes(x = month, y = amount))  +
  geom_boxplot() + ylim(0,150)

ggsave("monthdonations.png", width = 7, height = 4, units = "in")
```


```{r}
ggplot(dhistall, aes(x = dow, y = amount))  +
  geom_boxplot() + ylim(0,150)
```


```{r}
#this is figure 2.6
ggplot(dhistall, aes(x = hourofday, y = amount)) +
  geom_pointdensity() +
  scale_color_viridis_c() + 
  ylim(0,250)
ggsave("timeofdaydonations.png", width = 7, height = 4, units = "in")
```

