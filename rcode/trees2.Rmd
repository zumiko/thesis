---
title: "trees"
author: "Claire Jellison"
date: "2/8/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}


lagsort<- function(lagrow){
  a <- lagrow[1]
  b <- lagrow[2] 
  c <- lagrow[3] 
  d <- lagrow[4] 
  e <- lagrow[5]
  
  vec <- c(a,b,c,d,e)
  
  vec <- sort(vec, decreasing = FALSE) # so the are in increasing order 
  vec
}
```



```{r}
dhist2short <- na.omit(dhist2) %>% ungroup(as.factor(urlsolid)) %>% select(lag1,lag2,lag3,lag4,lag5)


lagsrt <- apply(dhist2short,1, lagsort) 
tlagsrt <- t(lagsrt)
tlagsrt <- as.data.frame(tlagsrt)
dhist2short$d1 <- tlagsrt[,1]
dhist2short$d2 <- tlagsrt[,2]
dhist2short$d3 <- tlagsrt[,3]
dhist2short$d4 <- tlagsrt[,4]
dhist2short$d5 <- tlagsrt[,5]
head(dhist2short)


max <- apply(dhist2short,1,max) 
max <- as.data.frame(max)
min <- apply(dhist2short,1,min) 
min <- as.data.frame(min)
lagsrt <- apply(dhist2short,1, lagsort) 
lagsrt <- as.data.frame(lapply(lagsrt,unlist))
nrow(dhist2short)
nrow(max)
dhist2more <- cbind.data.frame(dhist2, max)
dhist2more <- cbind.data.frame(dhist2more, min)
head(dhist2more,10)
```


put them in order of smallest to greatest 
d_1, d_2, d_3, d_4, d_5 

```{r}
dhist2omit <- na.omit(dhist2) %>% ungroup(as.factor(urlsolid)) %>% select(amount)
dhist2tree <- dhist2short
dhist2tree$amount <- dhist2omit

```

now time for the basic tree model

```{r}
library(tree)
library(gbm)
```



```{r}
treebasic= tree(amount ~. , data = dhist2tree)
```


